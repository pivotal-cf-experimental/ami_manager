#!/usr/bin/env ruby

require 'ami_manager/deployer'

if __FILE__ ==  $0
  %w(
    AWS_AMI_ID
    AWS_ACCESS_KEY
    AWS_SECRET_KEY
    SSH_KEY_NAME
    SSH_KEY_PATH
  ).each do |env_variable|
    raise "Missing ENV variable #{env_variable}" unless ENV[env_variable]
  end

  AmiManager::Deployer.new.deploy(
    aws_ami_id: ENV['AWS_AMI_ID'],
    aws_access_key: ENV['AWS_ACCESS_KEY'],
    aws_secret_key: ENV['AWS_SECRET_KEY'],
    ssh_key_name: ENV['SSH_KEY_NAME'],
    ssh_key_path: ENV['SSH_KEY_PATH'],
    )
end
